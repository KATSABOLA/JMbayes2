<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Recurrent Events â€¢ JMbayes2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Recurrent Events">
<meta property="og:description" content="JMbayes2">
<meta property="og:image" content="https://drizopoulos.github.io/JMbayes2/reference/figures/square_logo.png">
<meta property="og:image:alt" content="JMbayes2: Extended Joint Models for Longitudinal and Time-to-Event Data">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@drizopoulos">
<meta name="twitter:site" content="@drizopoulos">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-YDBZ5DBBSP"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YDBZ5DBBSP');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">JMbayes2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/JMbayes2.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Competing_Risks.html">Competing Risks</a>
    </li>
    <li>
      <a href="../articles/Dynamic_Predictions.html">Dynamic Predictions</a>
    </li>
    <li>
      <a href="../articles/Multi_State_Processes.html">Multi-State Processes</a>
    </li>
    <li>
      <a href="../articles/Non_Gaussian_Mixed_Models.html">Non-Gaussian Mixed Models</a>
    </li>
    <li>
      <a href="../articles/Recurring_Events.html">Recurrent Events</a>
    </li>
    <li>
      <a href="../articles/Transformation_Functions.html">Transformation Functions for Functional Forms</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/drizopoulos/JMbayes2/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Recurrent Events</h1>
                        <h4 data-toc-skip class="author">Pedro Miranda Afonso</h4>
            
            <h4 data-toc-skip class="date">2022-02-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/drizopoulos/JMbayes2/blob/HEAD/vignettes/Recurring_Events.Rmd" class="external-link"><code>vignettes/Recurring_Events.Rmd</code></a></small>
      <div class="hidden name"><code>Recurring_Events.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="recurrent-events">Recurrent events<a class="anchor" aria-label="anchor" href="#recurrent-events"></a>
</h2>
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p><strong>JMbayes2</strong> provides also the capability to fit joint models with a recurrent event process possibly combined with a terminating event. Recurrent events are correlated events that may occur more than once over the follow-up period for a given subject. Our current implementation allows for multiple longitudinal markers with different distributions, and various functional forms to link these markers with the risk of recurrent and terminal events. Furthermore, it enables the risk intervals to be defined in terms of the <em>gap</em> or <em>calendar</em> timescales. The two timescales use a different zero-time reference. The <em>calendar</em> uses the study entry, while the <em>gap</em> uses the end of the previous event (Figure 1). <em>Gap</em> assumes a renewal after each event and resets the time to zero.</p>
<div class="figure" style="text-align: center">
<img src="Recurring_Events_files/figure-html/timescale-1.png" alt="&lt;b&gt;Figure 1&lt;/b&gt; Visual representation of an hazard function under the gap or calendar timescale. During the folow-up the subject experienced three events." width="528"><p class="caption">
<b>Figure 1</b> Visual representation of an hazard function under the gap or calendar timescale. During the folow-up the subject experienced three events.
</p>
</div>
<p>The model also accommodates discontinuous risk intervals, i.e., periods in which the subject is not at risk of experiencing the recurring event (Figure 2). For example, while a patient is in the hospital, they are not at risk of being hospitalized again.</p>
<div class="figure" style="text-align: center">
<img src="Recurring_Events_files/figure-html/disc_risk-1.png" alt="&lt;b&gt;Figure 2&lt;/b&gt; Visual representation of an hazard function under the gap or calendar timescale, while accounting for non-risk periods (gray areas). During the folow-up the subject experienced three events." width="528"><p class="caption">
<b>Figure 2</b> Visual representation of an hazard function under the gap or calendar timescale, while accounting for non-risk periods (gray areas). During the folow-up the subject experienced three events.
</p>
</div>
<p>A joint model with <span class="math inline">\(p\)</span> normally distributed longitudinal markers, a terminal event process, and a recurrent event process can be described as follows: <span class="math display">\[\small{\require{color}
\begin{cases}
y_{1_i}(t)= \colorbox{#79FCFD80}{$ x_{1_i}(t)^\top\beta_1 +  z_{1_i}(t)^\top b_{1_i}$} + \varepsilon_1(t) = \colorbox{#79FCFD80}{$ \eta_{1_i}(t)$} + \varepsilon_1(t) &amp; \text{Longitudinal marker 1}\\
\vdots \\
y_{p_i}(t)= \colorbox{#FCFF5580}{$ x_{p_i}(t)^\top\beta_p +  z_{p_i}(t)^\top b_{p_i}$} + \varepsilon_p(t) = \colorbox{#FCFF5580}{$ \eta_{p_i}(t)$} + \varepsilon_p(t) &amp; \text{Longitudinal marker p}\\
h_{T_i}(t)= h_{T_0}(t)\exp\left\{  w_{T_i}(t)^\top \gamma_T + \colorbox{#79FCFD80}{$\mathcal{f}_{T_1}\left\{\eta_{1_i}(t)\right\}$} \alpha_{T_1} + \dots + \colorbox{#FCFF5580}{$\mathcal{f}_{T_p}\left\{\eta_{p_i}(t)\right\}$} \alpha_{T_p} + \colorbox{#5FFFAB80}{$b_{F_i}$} \alpha_{F} \right\} &amp; \text{Terminal event}\\
h_{R_i}(t)= h_{R_0}(t)\exp\left\{  w_{R_i}(t)^\top \gamma_R + \colorbox{#79FCFD80}{$\mathcal{f}_{R_1}\left\{\eta_{2_i}(t)\right\}$} \alpha_{R_1} + \dots + \colorbox{#FCFF5580}{$\mathcal{f}_{R_p}\left\{\eta_{p_i}(t)\right\}$} \alpha_{R_p} + \colorbox{#5FFFAB80}{$b_{F_i}$} \right\} &amp; \text{Recurrent event}\\
\end{cases},
}
\]</span> <br><span class="math display">\[
\begin{pmatrix} \colorbox{#79FCFD80}{$b_{1_i}$} \\ \vdots \\ \colorbox{#FCFF5580}{$b_{p_i}$} \\ \colorbox{#5FFFAB80}{$b_{F_i}$}\end{pmatrix} \sim MVN \left(0, \begin{pmatrix}D &amp; 0 \\ &amp; \sigma^2_F\end{pmatrix}\right), \qquad
\varepsilon(t) \sim N \left(0, \sigma^2\right),
\]</span> <br></p>
<p>where <span class="math inline">\(i = 1, \ldots, n\)</span>. For the longitudinal outcomes we specify linear mixed-effects models, and for the terminal and recurrence processes, we use proportional hazard models. The longitudinal and event time processes are linked via a latent structure of random effects, highlighted by the same color in the equations above. The terms <span class="math inline">\(\mathcal{f}_{R_j}\left\{\eta_{j_i}(t)\right\}\)</span> and <span class="math inline">\(\mathcal{f}_{R_j}\left\{\eta_{j_i}(t)\right\}\)</span> describe the functional forms that link the longitudinal marker <span class="math inline">\(j\)</span> with the risk of the recurrent and terminal events, respectively. The frailty <span class="math inline">\(b_{F_i}\)</span> is a random effect that accounts for the correlations in the recurrent events. The coefficient <span class="math inline">\(\alpha_{F}\)</span> quantifies the strength of the association between the terminal and recurrent event processes. For notational simplicity, in the formulation presented above we have shown normally distributed longitudinal outcomes; however, <strong>JMbayes2</strong> provides the option to consider longitudinal outcomes with <a href="https://drizopoulos.github.io/JMbayes2/articles/Non_Gaussian_Mixed_Models.html">different distributions</a>.</p>
</div>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<div class="section level4">
<h4 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h4>
<p>We simulate data from a joint model with three outcomes: one longitudinal outcome, one terminal failure-time, and one recurrent failure-time. We assume that the underlying value of the longitudinal outcome is associated with both risk models and use the <em>gap</em> timescale. The reader can easily extend this example to accommodate multiple longitudinal markers with other forms of association, exclude the terminal event, or use a different timescale.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gen_data</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>
  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span> <span class="co"># desired number of subjects </span>
  <span class="va">n_i</span> <span class="op">&lt;-</span> <span class="fl">15</span>  <span class="co"># number of (planned) measurements per subject</span>
  <span class="va">tmax</span> <span class="op">&lt;-</span> <span class="fl">7</span> <span class="co"># maximum follow-up time (type I censoring)</span>
  <span class="va">scale</span> <span class="op">&lt;-</span> <span class="st">"gap"</span> <span class="co"># hazard timescale</span>
  <span class="co">##############################################################################</span>
  <span class="va">n_scl</span> <span class="op">&lt;-</span> <span class="fl">1.5</span>
  <span class="va">n_target</span> <span class="op">&lt;-</span> <span class="va">n</span>
  <span class="va">n</span> <span class="op">&lt;-</span> <span class="va">n</span> <span class="op">*</span> <span class="va">n_scl</span>
  <span class="co"># longitudinal outcome 1/2</span>
  <span class="co">## param true values</span>
  <span class="va">betas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span> <span class="op">=</span> <span class="fl">6.94</span>, <span class="st">"Time1"</span> <span class="op">=</span> <span class="fl">1.30</span>, <span class="st">"Time2"</span> <span class="op">=</span> <span class="fl">1.84</span>, <span class="st">"Time3"</span> <span class="op">=</span> <span class="fl">1.82</span><span class="op">)</span>
  <span class="va">sigma_y</span> <span class="op">&lt;-</span> <span class="fl">0.6</span> <span class="co"># measurement error sd</span>
  <span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>
  <span class="va">D</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">D</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.71</span>, <span class="fl">0.33</span>, <span class="fl">0.07</span>, <span class="fl">1.26</span>, <span class="fl">2.68</span>, <span class="fl">3.81</span>, <span class="fl">4.35</span>, <span class="fl">7.62</span>, <span class="fl">5.4</span>, <span class="fl">8</span><span class="op">)</span>
  <span class="va">D</span> <span class="op">&lt;-</span> <span class="va">D</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.5</span>
  <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span><span class="op">)</span>, <span class="va">D</span><span class="op">)</span>
  <span class="va">Bkn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">7</span><span class="op">)</span>
  <span class="va">kn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">remove</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span>
  <span class="co">##############################################################################</span>
  <span class="co"># terminal outcome</span>
  <span class="co">## param true values</span>
  <span class="va">gammas_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(Intercept)"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">9</span>, <span class="st">"Group"</span> <span class="op">=</span> <span class="fl">0.5</span>, <span class="st">"Age"</span> <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="co"># phi = exp(Intercept)</span>
  <span class="va">sigma_t</span> <span class="op">&lt;-</span> <span class="fl">2</span>
  <span class="va">alpha_t</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="co"># association biomarker</span>
  <span class="va">alphaF</span> <span class="op">&lt;-</span> <span class="fl">0.25</span> <span class="co"># association frailty</span>
  <span class="va">sigmaF</span> <span class="op">&lt;-</span> <span class="fl">0.25</span> <span class="co"># frailty SD</span>
  <span class="va">frailty</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="va">sigmaF</span><span class="op">)</span>
  <span class="co">## terminal data</span>
  <span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, each <span class="op">=</span> <span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="va">age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">30</span>, <span class="fl">70</span><span class="op">)</span>
  <span class="va">W_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="st">"(Intercept)"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"Group"</span> <span class="op">=</span> <span class="va">group</span>, <span class="st">"Age"</span> <span class="op">=</span> <span class="va">age</span><span class="op">)</span>
  <span class="va">eta_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">W_t</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">gammas_t</span> <span class="op">+</span> <span class="va">alphaF</span> <span class="op">*</span> <span class="va">frailty</span><span class="op">)</span> 
  <span class="va">invS_t</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">u</span>, <span class="va">i</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">h</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">{</span> 
      <span class="va">NS</span> <span class="op">&lt;-</span> <span class="fu">splines</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">s</span>, knots <span class="op">=</span> <span class="va">kn</span>, Boundary.knots <span class="op">=</span> <span class="va">Bkn</span><span class="op">)</span>
      <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">NS</span><span class="op">)</span>
      <span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">NS</span><span class="op">)</span>
      <span class="va">eta_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">betas</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">Z</span> <span class="op">*</span> <span class="va">b</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">i</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span>
      <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">sigma_t</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">sigma_t</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">+</span> <span class="va">eta_t</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">eta_y</span> <span class="op">*</span> <span class="va">alpha_t</span><span class="op">)</span> 
    <span class="op">}</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></span><span class="op">(</span><span class="va">h</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="va">t</span><span class="op">)</span><span class="op">$</span><span class="va">value</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">u_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
  <span class="va">ter_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">root</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot</a></span><span class="op">(</span><span class="va">invS_t</span>, interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-05</span>, <span class="fl">250</span><span class="op">)</span>, <span class="co"># arbitrary upper limit</span>
                        u <span class="op">=</span> <span class="va">u_t</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, i <span class="op">=</span> <span class="va">i</span><span class="op">)</span><span class="op">$</span><span class="va">root</span>, <span class="cn">TRUE</span><span class="op">)</span>  
    <span class="va">ter_times</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">root</span>, <span class="st">"try-error"</span><span class="op">)</span><span class="op">)</span> <span class="va">root</span> <span class="kw">else</span> <span class="cn">NA</span>
  <span class="op">}</span>
  <span class="va">ter_na</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">ter_times</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ter_na</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">n_target</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Not enough patients. Increase 'n_scl'."</span><span class="op">)</span>
  <span class="va">rmv_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">ter_na</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ter_na</span><span class="op">)</span> <span class="op">-</span> <span class="va">n_target</span><span class="op">)</span>
  <span class="va">ter_na</span><span class="op">[</span><span class="va">rmv_ids</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span> <span class="co"># remove the excess of subjects</span>
  <span class="va">ter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>id    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">[</span><span class="va">ter_na</span><span class="op">]</span>,
                     time  <span class="op">=</span> <span class="va">ter_times</span><span class="op">[</span><span class="va">ter_na</span><span class="op">]</span>,
                     group <span class="op">=</span> <span class="va">group</span><span class="op">[</span><span class="va">ter_na</span><span class="op">]</span>,
                     age   <span class="op">=</span> <span class="va">age</span><span class="op">[</span><span class="va">ter_na</span><span class="op">]</span><span class="op">)</span>
  <span class="va">frailty</span> <span class="op">&lt;-</span> <span class="va">frailty</span><span class="op">[</span><span class="va">ter_na</span><span class="op">]</span>
  <span class="va">b</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">[</span><span class="va">ter_na</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>
  <span class="va">cens_times</span> <span class="op">&lt;-</span> <span class="va">tmax</span>
  <span class="va">ter</span><span class="op">$</span><span class="va">status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">ter</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;=</span> <span class="va">cens_times</span><span class="op">)</span> <span class="co"># event indicator</span>
  <span class="va">ter</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">ter</span><span class="op">$</span><span class="va">time</span>, <span class="va">cens_times</span><span class="op">)</span> <span class="co"># add censoring time</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">remove</a></span><span class="op">(</span><span class="va">gammas_t</span>, <span class="va">sigma_t</span>, <span class="va">group</span>, <span class="va">W_t</span>, <span class="va">eta_t</span>, <span class="va">alpha_t</span>, <span class="va">invS_t</span>, <span class="va">u_t</span>, <span class="va">i</span>, <span class="va">root</span>, 
         <span class="va">n_target</span>, <span class="va">rmv_ids</span>, <span class="va">ter_times</span>, <span class="va">cens_times</span>, <span class="va">n</span>, <span class="va">alphaF</span>, <span class="va">age</span>, <span class="va">ter_na</span>,
         <span class="va">sigmaF</span><span class="op">)</span>
  <span class="co">##############################################################################</span>
  <span class="co"># recurring outcome</span>
  <span class="co">## param true values</span>
  <span class="va">gammas_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(Intercept)"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">9</span><span class="op">+</span><span class="fl">3</span>, <span class="st">"Group"</span> <span class="op">=</span> <span class="fl">0.5</span>, <span class="st">"Age"</span> <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="co"># phi = exp(Intercept)</span>
  <span class="va">sigma_r</span> <span class="op">&lt;-</span> <span class="fl">2</span>
  <span class="va">alpha_r</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="co"># association biomarker</span>
  <span class="co">## recurring data</span>
  <span class="va">W_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="st">"(Intercept)"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"Group"</span> <span class="op">=</span> <span class="va">ter</span><span class="op">$</span><span class="va">group</span>, <span class="st">"Age"</span> <span class="op">=</span> <span class="va">ter</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>
  <span class="va">eta_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">W_r</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">gammas_r</span> <span class="op">+</span> <span class="va">frailty</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">scale</span> <span class="op">==</span> <span class="st">"gap"</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">invS_r</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">u</span>, <span class="va">i</span>, <span class="va">tstart</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">h</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">{</span> 
        <span class="va">NS</span> <span class="op">&lt;-</span> <span class="fu">splines</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">s</span> <span class="op">+</span> <span class="va">tstart</span>, knots <span class="op">=</span> <span class="va">kn</span>, Boundary.knots <span class="op">=</span> <span class="va">Bkn</span><span class="op">)</span>
        <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">NS</span><span class="op">)</span>
        <span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">NS</span><span class="op">)</span>
        <span class="va">eta_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">betas</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">Z</span> <span class="op">*</span> <span class="va">b</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">i</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span>
        <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">sigma_r</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">sigma_r</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">+</span> <span class="va">eta_r</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">eta_y</span> <span class="op">*</span> <span class="va">alpha_r</span><span class="op">)</span> 
      <span class="op">}</span>
      <span class="fu"><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></span><span class="op">(</span><span class="va">h</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="va">t</span><span class="op">)</span><span class="op">$</span><span class="va">value</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span>
    <span class="op">}</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">scale</span> <span class="op">==</span> <span class="st">"calendar"</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">invS_r</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">u</span>, <span class="va">i</span>, <span class="va">tstart</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">h</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">{</span> 
        <span class="va">NS</span> <span class="op">&lt;-</span> <span class="fu">splines</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">s</span> <span class="op">+</span> <span class="va">tstart</span>, knots <span class="op">=</span> <span class="va">kn</span>, Boundary.knots <span class="op">=</span> <span class="va">Bkn</span><span class="op">)</span>
        <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">NS</span><span class="op">)</span>
        <span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">NS</span><span class="op">)</span>
        <span class="va">eta_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">betas</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">Z</span> <span class="op">*</span> <span class="va">b</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">i</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span>
        <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">sigma_r</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">sigma_r</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">s</span> <span class="op">+</span> <span class="va">tstart</span><span class="op">)</span> <span class="op">+</span> <span class="va">eta_r</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">eta_y</span> <span class="op">*</span> <span class="va">alpha_r</span><span class="op">)</span> 
      <span class="op">}</span>
      <span class="fu"><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></span><span class="op">(</span><span class="va">h</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="va">t</span><span class="op">)</span><span class="op">$</span><span class="va">value</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span>
    <span class="op">}</span>
  <span class="op">}</span>
  <span class="va">stop_times</span> <span class="op">&lt;-</span> <span class="va">start_times</span> <span class="op">&lt;-</span> <span class="va">id_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">j</span> <span class="op">&lt;-</span> <span class="fl">1</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ter</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">tstart</span> <span class="op">&lt;-</span> <span class="fl">0</span>
    <span class="kw">while</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">tstart</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">tstart</span> <span class="op">&lt;</span> <span class="va">ter</span><span class="op">$</span><span class="va">time</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">u_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
      <span class="va">root</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot</a></span><span class="op">(</span><span class="va">invS_r</span>, interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-05</span>, <span class="fl">250</span><span class="op">)</span>, <span class="co"># arbitrary upper limit</span>
                          u <span class="op">=</span> <span class="va">u_r</span>, i <span class="op">=</span> <span class="va">i</span>, tstart <span class="op">=</span> <span class="va">tstart</span><span class="op">)</span><span class="op">$</span><span class="va">root</span>, <span class="cn">TRUE</span><span class="op">)</span>  
      <span class="va">tstop</span> <span class="op">&lt;-</span> <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">root</span>, <span class="st">"try-error"</span><span class="op">)</span><span class="op">)</span> <span class="va">root</span> <span class="kw">else</span> <span class="cn">NA</span>
      <span class="va">start_times</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tstart</span>
      <span class="va">stop_times</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tstart</span> <span class="op">+</span> <span class="va">tstop</span>
      <span class="va">dur</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0.1</span><span class="op">)</span> <span class="co"># recurrent event duration</span>
      <span class="va">tstart</span> <span class="op">&lt;-</span> <span class="va">tstart</span> <span class="op">+</span> <span class="va">tstop</span> <span class="op">+</span> <span class="va">dur</span>
      <span class="va">id_times</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ter</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
      <span class="va">j</span> <span class="op">&lt;-</span> <span class="va">j</span> <span class="op">+</span> <span class="fl">1</span>
    <span class="op">}</span>
  <span class="op">}</span>
  <span class="va">rec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>id     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">id_times</span><span class="op">)</span>,                       
                    tstart <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">start_times</span><span class="op">)</span>,
                    tstop  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">stop_times</span><span class="op">)</span><span class="op">)</span>
  <span class="va">rec</span><span class="op">$</span><span class="va">id</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">rec</span><span class="op">$</span><span class="va">id</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">rec</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="co"># rename IDs</span>
  <span class="va">rec</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="va">ter</span><span class="op">$</span><span class="va">group</span><span class="op">[</span><span class="va">rec</span><span class="op">$</span><span class="va">id</span><span class="op">]</span>
  <span class="va">rec</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;-</span> <span class="va">ter</span><span class="op">$</span><span class="va">age</span><span class="op">[</span><span class="va">rec</span><span class="op">$</span><span class="va">id</span><span class="op">]</span>
  <span class="va">rec</span><span class="op">$</span><span class="va">Stime</span> <span class="op">&lt;-</span> <span class="va">ter</span><span class="op">$</span><span class="va">time</span><span class="op">[</span><span class="va">rec</span><span class="op">$</span><span class="va">id</span><span class="op">]</span>
  <span class="va">rec</span><span class="op">$</span><span class="va">status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">rec</span><span class="op">$</span><span class="va">tstop</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">rec</span><span class="op">$</span><span class="va">tstop</span> <span class="op">&lt;</span> <span class="va">rec</span><span class="op">$</span><span class="va">Stime</span><span class="op">)</span>  <span class="co"># event indicator</span>
  <span class="va">rec</span><span class="op">$</span><span class="va">tstop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">rec</span><span class="op">$</span><span class="va">tstop</span>, <span class="va">rec</span><span class="op">$</span><span class="va">Stime</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># add cens time</span>
  <span class="va">rec</span><span class="op">$</span><span class="va">Stime</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
  <span class="va">ter</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ter</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">remove</a></span><span class="op">(</span><span class="va">gammas_r</span>, <span class="va">sigma_r</span>, <span class="va">W_r</span>, <span class="va">eta_r</span>, <span class="va">alpha_r</span>, <span class="va">invS_r</span>, <span class="va">stop_times</span>, <span class="va">start_times</span>, 
         <span class="va">id_times</span>, <span class="va">dur</span>, <span class="va">j</span>, <span class="va">i</span>, <span class="va">tstart</span>, <span class="va">u_r</span>, <span class="va">root</span>, <span class="va">tstop</span><span class="op">)</span>
  <span class="co">##############################################################################</span>
  <span class="co"># longitudinal outcome 2/2</span>
  <span class="va">long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>id   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">ter</span><span class="op">$</span><span class="va">id</span>, each <span class="op">=</span> <span class="va">n_i</span><span class="op">)</span>,
                     time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ter</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="va">tmax</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/methods.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu">splines</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">time</span>, knots <span class="op">=</span> <span class="va">kn</span>, Boundary.knots <span class="op">=</span> <span class="va">Bkn</span><span class="op">)</span>, 
                    data <span class="op">=</span> <span class="va">long</span><span class="op">)</span>
  <span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/methods.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu">splines</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">time</span>, knots <span class="op">=</span> <span class="va">kn</span>, Boundary.knots <span class="op">=</span> <span class="va">Bkn</span><span class="op">)</span>, 
                    data <span class="op">=</span> <span class="va">long</span><span class="op">)</span>
  <span class="va">eta_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">betas</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">Z</span> <span class="op">*</span> <span class="va">b</span><span class="op">[</span><span class="va">long</span><span class="op">$</span><span class="va">id</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span>
  <span class="va">long</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">eta_y</span><span class="op">)</span>, <span class="va">eta_y</span>, <span class="va">sigma_y</span><span class="op">)</span>
  <span class="va">long_cens</span> <span class="op">&lt;-</span> <span class="va">long</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">ter</span><span class="op">$</span><span class="va">time</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rle.html" class="external-link">rle</a></span><span class="op">(</span><span class="va">long</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">$</span><span class="va">lengths</span><span class="op">)</span> 
  <span class="va">long</span> <span class="op">&lt;-</span> <span class="va">long</span><span class="op">[</span><span class="va">long_cens</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span> <span class="co"># drop censored encounters</span>
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">remove</a></span><span class="op">(</span><span class="va">kn</span>, <span class="va">Bkn</span>, <span class="va">X</span>, <span class="va">betas</span>, <span class="va">Z</span>, <span class="va">b</span>, <span class="va">eta_y</span>, <span class="va">sigma_y</span>, <span class="va">n_i</span>, <span class="va">tmax</span>, <span class="va">long_cens</span>, <span class="va">scale</span><span class="op">)</span>
  <span class="co">##############################################################################</span>
  <span class="co"># return</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>long <span class="op">=</span> <span class="va">long</span>, ter <span class="op">=</span> <span class="va">ter</span>, rec <span class="op">=</span> <span class="va">rec</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2022</span><span class="op">)</span>; <span class="va">fake_data</span> <span class="op">&lt;-</span> <span class="fu">gen_data</span><span class="op">(</span><span class="op">)</span>
<span class="va">term_data</span> <span class="op">&lt;-</span> <span class="va">fake_data</span><span class="op">$</span><span class="va">ter</span> <span class="co"># terminal event data</span>
<span class="va">recu_data</span> <span class="op">&lt;-</span> <span class="va">fake_data</span><span class="op">$</span><span class="va">rec</span> <span class="co"># recurrent events data</span>
<span class="va">lme_data</span> <span class="op">&lt;-</span> <span class="va">fake_data</span><span class="op">$</span><span class="va">long</span> <span class="co"># longitudial marker data</span></code></pre></div>
<p>We now have three data frames, each one corresponding to a different outcome. To fit the joint model, the user needs to organize the failure-time data in the counting process formulation by combining the data for the terminal and recurrent events. Using then a strata variable to distinguish between the two processes. To facilitate this, we provide in the package the <code><a href="../reference/rc_setup.html">rc_setup()</a></code> function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cox_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rc_setup.html">rc_setup</a></span><span class="op">(</span>rc_data <span class="op">=</span> <span class="va">recu_data</span>, trm_data <span class="op">=</span> <span class="va">term_data</span>,
                     rc_idVar <span class="op">=</span> <span class="st">"id"</span>, rc_statusVar <span class="op">=</span> <span class="st">"status"</span>,
                     rc_startVar <span class="op">=</span> <span class="st">"tstart"</span>, rc_stopVar <span class="op">=</span> <span class="st">"tstop"</span>,
                     trm_idVar <span class="op">=</span> <span class="st">"id"</span>, trm_statusVar <span class="op">=</span> <span class="st">"status"</span>,
                     trm_stopVar <span class="op">=</span> <span class="st">"time"</span>,
                     nameStrata <span class="op">=</span> <span class="st">"strata"</span>, nameStatus <span class="op">=</span> <span class="st">"status"</span><span class="op">)</span></code></pre></div>
<p>Each subject has as many rows in the new data frame as the number of their recurrent risk periods plus one for the terminal event. The data frame follows the counting process formulation with the risk intervals delimited by <code>start</code> and <code>stop</code> variables. The <code>strata</code> variable denotes if the type of event, <code>1</code> if recurrent or <code>2</code> terminal. The <code>status</code> equals <code>1</code> if the subject had an event and <code>0</code> otherwise. As shown below and in Figure 3, the subject 1 experienced seven recurrent events during the follow up; the eighth recurrent event was censored by the terminal event.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cox_data</span><span class="op">[</span><span class="va">cox_data</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"tstart"</span>, <span class="st">"tstop"</span>, <span class="st">"status"</span>, <span class="st">"strata"</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;     id    tstart     tstop status strata</span>
<span class="co">#&gt; 1    1 0.0000000 0.3756627      1      1</span>
<span class="co">#&gt; 2    1 0.4275324 0.7832841      1      1</span>
<span class="co">#&gt; 3    1 0.8724938 1.0863887      1      1</span>
<span class="co">#&gt; 4    1 1.1212953 1.8741434      1      1</span>
<span class="co">#&gt; 5    1 1.9372355 2.7843451      1      1</span>
<span class="co">#&gt; 6    1 2.7906559 3.4618622      1      1</span>
<span class="co">#&gt; 7    1 3.5166929 3.5830169      1      1</span>
<span class="co">#&gt; 8    1 3.6251219 4.0375415      0      1</span>
<span class="co">#&gt; 8.1  1 0.0000000 4.0375415      1      2</span></code></pre></div>
<div class="figure">
<img src="Recurring_Events_files/figure-html/trf_data3-1.png" alt="&lt;b&gt;Figure 3&lt;/b&gt; Visual representation of the failure-time data during the follow-up for subject 1. The horizontal black line denotes risk periods, while the blue line non-risk periods. 'R' and 'T' represent a recurrent and terminal event, respectively." width="528"><p class="caption">
<b>Figure 3</b> Visual representation of the failure-time data during the follow-up for subject 1. The horizontal black line denotes risk periods, while the blue line non-risk periods. â€˜Râ€™ and â€˜Tâ€™ represent a recurrent and terminal event, respectively.
</p>
</div>
</div>
<div class="section level4">
<h4 id="fitting-the-model">Fitting the model<a class="anchor" aria-label="anchor" href="#fitting-the-model"></a>
</h4>
<p>The user then needs to use the <code><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">nlme::lme()</a></code> function to first fit the linear mixed model that describes the longitudinal outcome,</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lme_fit</span> <span class="op">&lt;-</span> <span class="fu">lme</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu">ns</span><span class="op">(</span><span class="va">time</span>, k <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span>, 
               random <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu">pdDiag</span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span> <span class="fu">ns</span><span class="op">(</span><span class="va">time</span>, k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, 
                                                       B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
               data <span class="op">=</span> <span class="va">lme_data</span>,
               control <span class="op">=</span> <span class="fu">lmeControl</span><span class="op">(</span>opt <span class="op">=</span> <span class="st">"optim"</span>, niterEM <span class="op">=</span> <span class="fl">45</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Then, we use the <code><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">survival::coxph()</a></code> function to fit a stratified Cox model using the transformed data,</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cox_fit</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">tstart</span>, <span class="va">tstop</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="op">(</span><span class="va">group</span> <span class="op">+</span> <span class="va">age</span><span class="op">)</span> <span class="op">*</span> <span class="fu">strata</span><span class="op">(</span><span class="va">strata</span><span class="op">)</span>,
                 data <span class="op">=</span> <span class="va">cox_data</span><span class="op">)</span></code></pre></div>
<p>These models are then provided as arguments in the <code><a href="../reference/jm.html">jm()</a></code> function. The user specifies the desired functional forms for the mixed model in each relative-risk model. And with the <code>recurrent</code> argument specifies the desired timescale,</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">jm_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/jm.html">jm</a></span><span class="op">(</span><span class="va">cox_fit</span>, <span class="va">lme_fit</span>, time_var <span class="op">=</span> <span class="st">"time"</span>, recurrent <span class="op">=</span> <span class="st">"gap"</span>,
             functional_forms <span class="op">=</span>  <span class="op">~</span> <span class="fu"><a href="../reference/jm.html">value</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">*</span> <span class="va">strata</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">jm_fit</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; jm(Surv_object = cox_fit, Mixed_objects = lme_fit, time_var = "time", </span>
<span class="co">#&gt;     recurrent = "gap", functional_forms = ~value(y) * strata)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Data Descriptives:</span>
<span class="co">#&gt; Number of Groups: 500        Number of events: 2250 (81.6%)</span>
<span class="co">#&gt; Number of Observations:</span>
<span class="co">#&gt;   y: 3075</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                  DIC     WAIC       LPML</span>
<span class="co">#&gt; marginal    13140.19 13213.38  -6990.955</span>
<span class="co">#&gt; conditional 19472.52 18930.07 -10270.700</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Random-effects covariance matrix:</span>
<span class="co">#&gt;                                                            </span>
<span class="co">#&gt;                        StdDev   Corr                       </span>
<span class="co">#&gt; (Intr)                 0.7920 (Intr) n(,k=c(1,3),B=c(0,7))1</span>
<span class="co">#&gt; n(,k=c(1,3),B=c(0,7))1 1.6326 0.3177                       </span>
<span class="co">#&gt; n(,k=c(1,3),B=c(0,7))2 2.3391 0.0601 0.6277                </span>
<span class="co">#&gt; n(,k=c(1,3),B=c(0,7))3 2.5483 0.5640 0.7549                </span>
<span class="co">#&gt;                                              </span>
<span class="co">#&gt;                                              </span>
<span class="co">#&gt; (Intr)                 n(,k=c(1,3),B=c(0,7))2</span>
<span class="co">#&gt; n(,k=c(1,3),B=c(0,7))1                       </span>
<span class="co">#&gt; n(,k=c(1,3),B=c(0,7))2                       </span>
<span class="co">#&gt; n(,k=c(1,3),B=c(0,7))3 0.5999                </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Frailty standard deviation:</span>
<span class="co">#&gt;                 Mean   2.5%  97.5%</span>
<span class="co">#&gt; sigma_frailty 0.2187 0.0146 0.3302</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Survival Outcome:</span>
<span class="co">#&gt;                          Mean  StDev    2.5%  97.5%      P   Rhat</span>
<span class="co">#&gt; group                  0.4791 0.0907  0.3000 0.6560 0.0000 1.0100</span>
<span class="co">#&gt; age                    0.0503 0.0029  0.0445 0.0562 0.0000 1.0143</span>
<span class="co">#&gt; group:strata(strata)2 -0.0249 0.1234 -0.2595 0.2385 0.8353 1.0163</span>
<span class="co">#&gt; age:strata(strata)2   -0.0003 0.0045 -0.0090 0.0087 0.9436 1.2005</span>
<span class="co">#&gt; value(y)               0.5145 0.0266  0.4643 0.5693 0.0000 1.0551</span>
<span class="co">#&gt; value(y):strata2       0.0099 0.0430 -0.0682 0.0875 0.8704 1.3037</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Longitudinal Outcome: y (family = gaussian, link = identity)</span>
<span class="co">#&gt;                          Mean  StDev   2.5%  97.5%      P   Rhat</span>
<span class="co">#&gt; (Intercept)            6.9828 0.1123 6.7613 7.2064 0.0000 1.0036</span>
<span class="co">#&gt; n(,k=c(1,3),B=c(0,7))1 1.2457 0.2113 0.8335 1.6768 0.0000 1.1051</span>
<span class="co">#&gt; n(,k=c(1,3),B=c(0,7))2 1.6099 0.4726 0.6691 2.5094 0.0000 1.0001</span>
<span class="co">#&gt; n(,k=c(1,3),B=c(0,7))3 1.5582 0.6385 0.3496 2.7784 0.0144 1.0054</span>
<span class="co">#&gt; sigma                  0.6147 0.0112 0.5928 0.6368 0.0000 1.0198</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MCMC summary:</span>
<span class="co">#&gt; chains: 3 </span>
<span class="co">#&gt; iterations per chain: 3500 </span>
<span class="co">#&gt; burn-in per chain: 500 </span>
<span class="co">#&gt; thinning: 1 </span>
<span class="co">#&gt; time: 2.2 min</span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="http://www.drizopoulos.com/" class="external-link">Dimitris Rizopoulos</a>, <a href="https://gregpapageorgiou.com/" class="external-link">Grigorios Papageorgiou</a>, <a href="https://pafonso.com/" class="external-link">Pedro Miranda Afonso</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '66a8ef39105517ba1ce2f07aa1c70890',
    indexName: 'drizopoulos',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
